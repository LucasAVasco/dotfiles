#!/bin/bash
#
# Automatically show the help message of a command.

# Remove all commands before the last one. Example: `command1 ; command2 && command3` will become `command3`
for ((i = $#; i > 0; i--)); do
	current_cmd="${@:i:1}"
	first_char="${current_cmd:0:1}"
	if [[ "$first_char" == ";" || "$first_char" == "&" || "$first_char" == "|" ]]; then
		shift $((i))
		break
	fi
done

# Remove all environment variables before the command. Example: `VAR1=value1 V2=value2 command arg1` will become `command arg1`
while [[ "$1" =~ .*=.* ]]; do
	shift
done

cmd_show_help=(batcat --language=help --style='grid' --paging=always --pager='less --raw-control-chars --clear-screen')

case "$1" in
	go)
		go help "${@:2}" | "${cmd_show_help[@]}"
	;;
	*)
		"$@" --help 2>&1 | "${cmd_show_help[@]}"
	;;
esac
